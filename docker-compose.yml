version: '3'
services: 
    mysql-server:
        image: mysql:5.7
        hostname: mysql-server
        container_name: mysql-server
        restart: always
        environment: 
            MYSQL_ROOT_PASSWORD: userpass
        volumes: 
            - ./db/data:/var/lib/mysql
            - ./db/dumps:/docker-entrypoint-initdb.d
        networks: 
            - mysql-net

    nodejs-container:
        image: abassi/nodejs-server:10.0-dev
        hostname: nodejs-container
        container_name: nodejs-container
        restart: always
        volumes: 
            - .:/home/node/app
        networks: 
            - mysql-net
        depends_on: 
            - mysql-server
        ports: 
            - "8000:3000"
        command: nodemon /home/node/app/ws/index.js
    
    phpadmin:
        image: phpmyadmin/phpmyadmin
        hostname: phpadmin
        container_name: phpadmin
        restart: always
        environment: 
            PMA_HOST: mysql-server
            PMA_PORT: 3306
            MYSQL_ROOT_PASSWORD: userpass
        networks: 
            - mysql-net
        depends_on: 
            - mysql-server
        ports: 
            - "8085:80"
networks: 
    mysql-net:
        driver: bridge